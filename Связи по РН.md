# Links → Worksets v2 | Распределение связей по рабочим наборам

## Что делает команда

- Автоматически раскладывает **Revit-связи (RVT)** и **импортированные DWG** по рабочим наборам по их названию/пути.
- При необходимости **создаёт недостающие рабочие наборы**.
- Для координатной связи (`КООРД` / `KOORD`) включает режим:
  - отдельный РН `00_Связи_RVT_00_КООРД`;
  - выключена дефолтная видимость;
  - РН скрыт во всех существующих видах.
- После распределения **закрепляет (Pin)** все связи и DWG.

Пример соответствий (по токенам в имени/файле):

- `КООРД`, `KOORD` → `00_Связи_RVT_00_КООРД` (координаты, скрывается в видах)
- `АР`, `AR`       → `00_Связи_RVT_01_АР`
- `КР`, `KR`       → `00_Связи_RVT_02_КР`
- `ОВ`, `OV`       → `00_Связи_RVT_03_ОВ`
- `ИТП`, `ITP`     → `00_Связи_RVT_03_ИТП`
- `ВК`, `VK`       → `00_Связи_RVT_04_ВК`
- `ВНС`, `VNS`     → `00_Связи_RVT_04_ВНС`
- `ПТ`, `PT`       → `00_Связи_RVT_04_ПТ`
- `ЭОМ`, `EOM`     → `00_Связи_RVT_05_ЭОМ`
- `СС`, `SS`       → `00_Связи_RVT_06_СС`
- все **DWG** → `00_Связи_DWG`

Скрипт понимает смешение латиницы и кириллицы в похожих буквах (A/А, B/В, C/С и т.п.).

---

## Как пользоваться

1. Откройте **рабочую (workshared) модель** Revit, в которой уже подключены RVT-связи и/или DWG.
2. Убедитесь, что в именах типов/экземпляров связей и/или именах файлов есть нужные токены (`АР`, `OV`, `VK`, `КООРД` и т.д.).
3. Нажмите кнопку скрипта на панели **pyRevit**.
4. Дождитесь выполнения:
   - скрипт автоматически найдёт все связи и DWG;
   - создаст недостающие рабочие наборы;
   - разложит связи и DWG по РН согласно правилам;
   - при необходимости скроет координатный РН во всех видах;
   - закрепит связи и DWG.

По завершении:

- В **оконце pyRevit** будет текстовый отчёт (сколько элементов обработано, какие РН созданы и т.п.).
- Появится всплывающее сообщение «Готово» с итоговой статистикой.

---

## Важно

- Скрипт работает **только в проектных файлах**, где включены **рабочие наборы**.
- Обрабатываются **все** Revit-связи и все DWG в модели — выбор элементов не требуется.
- Если по токенам ничего не найдено, скрипт сообщит об этом и покажет диагностическую таблицу в окне pyRevit.
