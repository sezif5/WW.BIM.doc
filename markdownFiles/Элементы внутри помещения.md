# Помещения → элементы (ИОС / АР)

## Что делает команда

**Режим ИОС**  
Записывает значение выбранного параметра помещения из АР-ссылки в выбранный параметр **MEP-элементов** в текущей модели.  
Если элемент не попадает ни в одно помещение, в параметр записывается текст `Вне помещения`.

**Режим АР**  
Записывает значение выбранного параметра помещения текущей модели в выбранный параметр **перекрытий**.  
Если перекрытие не попадает ни в одно помещение, в параметр записывается `Вне помещения`.

---

## Как пользоваться (общая логика)

1. Нажмите кнопку скрипта на панели **pyRevit**.
2. В окне выберите режим:
   - `ИОС — MEP элементы + помещения из AR-ссылки`
   - `АР — Перекрытия + помещения текущей модели`

---

## Режим ИОС (MEP по помещениям из АР-ссылки)

1. Выберите ссылку АР, из которой брать помещения (если их несколько).
2. Выберите **параметр помещения** – источник (например, `Имя`, `Номер`, `ADSK_Помещение` и т.п.).
3. Выберите **параметр элемента** – приёмник, куда писать значение (по умолчанию предлагается `ADSK_Помещение`).
4. Скрипт пройдётся по всем инженерным элементам (трубы, воздуховоды, оборудование и т.д.) и:
   - найдёт, в каких помещениях они находятся;
   - запишет выбранное значение параметра помещения в выбранный параметр элемента;
   - если помещение не найдено, запишет `Вне помещения`.

---

## Режим АР (перекрытия по помещениям текущей модели)

1. Выберите **параметр помещения** – источник из текущей модели.
2. Выберите **параметр перекрытия** – приёмник (по умолчанию предлагается `ADSK_Помещение`).
3. Скрипт пройдётся по всем перекрытиям и:
   - определит, в каком помещении находится перекрытие;
   - запишет значение выбранного параметра помещения в выбранный параметр перекрытия;
   - если помещение не найдено, запишет `Вне помещения`.

---

## Результат

После выполнения скрипт покажет краткий отчёт:

- сколько элементов обработано;
- для скольких записано значение помещения;
- для скольких установлено `Вне помещения`;
- для скольких не удалось записать параметр (например, если он только для чтения).
